<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-title>Ice Cream</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="ion-padding">
  <div class="ion-margin-bottom">
    <h3>
      Scoops flavours
      <span
        *ngIf="totalScoops >= 5"
        style="
          color: var(--ion-color-danger);
          font-size: 0.8em;
          margin-left: 10px;
        "
      >
        too many scoops selected
      </span>
    </h3>

    <ion-grid>
      @for (flavor of flavors; track flavor.id) {
      <ion-row class="ion-align-items-center ion-margin-bottom">
        <ion-col size="auto">
          <ion-img
            [src]="flavor.image"
            style="width: 50px; height: 50px"
          ></ion-img>
        </ion-col>

        <ion-col>
          <ion-label>{{ flavor.name }}</ion-label>
        </ion-col>

        <ion-col size="auto">
          <ion-button
            (click)="onSub(flavor)"
            [disabled]="flavor.quantity === 0"
            color="light"
            size="small"
            >-</ion-button
          >
        </ion-col>

        <ion-col size="auto">
          <ion-button
            (click)="onAdd(flavor)"
            [disabled]="totalScoops >= 5"
            color="light"
            size="small"
            >+</ion-button
          >
        </ion-col>

        <ion-col size="auto" style="min-width: 30px; text-align: center">
          <ion-label><strong>{{ flavor.quantity }}</strong></ion-label>
        </ion-col>

        <ion-col size="auto">
          <ion-icon
            *ngIf="flavor.stock === 0 || flavor.id === 'pistachio'"
            name="alert-circle"
            color="danger"
            size="large"
            [routerLink]="['/order', flavor.id]"
            style="cursor: pointer"
          >
          </ion-icon>
        </ion-col>
      </ion-row>
      }
    </ion-grid>
  </div>

  <div class="ion-margin-bottom">
    <h3>Cone or cup</h3>
    <ion-radio-group
      [value]="selectedContainerId"
      (ionChange)="onContainerChange($event)"
    >
      @for (container of containers; track container.id) {
      <ion-item lines="none">
        <ion-radio [value]="container.id" labelPlacement="end"
          >{{ container.name }}</ion-radio
        >
        <ion-note slot="end">
          {{ container.price === 0 ? 'free' : '€ ' + container.price }}
        </ion-note>
      </ion-item>
      }
    </ion-radio-group>
  </div>

  <div class="ion-margin-bottom">
    <h3>Extras</h3>
    <ion-list lines="none">
      @for (extra of extras; track extra.id) {
      <ion-item>
        <ion-checkbox
          labelPlacement="end"
          (ionChange)="onExtraChange(extra, $event)"
        >
          {{ extra.name }}
        </ion-checkbox>
        <ion-note slot="end">€ {{ extra.price | number:'1.2-2' }}</ion-note>
      </ion-item>
      }
    </ion-list>
  </div>

  <div class="ion-margin-top">
    <h2>
      Price
      <span style="float: right">€ {{ totalPrice | number:'1.2-2' }}</span>
    </h2>
  </div>
</ion-content>

<ion-footer>
  <ion-toolbar>
    <ion-button
      expand="block"
      (click)="makeIceCream()"
      [disabled]="totalScoops === 0"
      class="ion-margin"
    >
      Make icecream
    </ion-button>
  </ion-toolbar>
</ion-footer>
